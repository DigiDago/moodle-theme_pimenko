define(["jquery","core/str","theme_boost/bootstrap/tooltip"],function(t,e,a){let n=t("#completioncheck").attr("data-modulename"),i=e.get_string("completion-tooltip-manual-y","theme_pimenko",n),l=e.get_string("completion-tooltip-manual-n","theme_pimenko",n),r=document.getElementsByTagName("input"),c=function(t){"OK"!==t&&alert("An error occurred when attempting to save your tick mark.\n\n("+o.responseText+".)")},s=function(t,e,o){alert("Failed: An error occurred when attempting to save your tick mark.\n\n("+e.responseText+".)")},d=function(e){e.preventDefault();let o=e.target,a=0,n=0,i=null,l=null,r=Y.Node.getDOMNode(o).getElementsByTagName("input");for(let e=0;e<r.length;e++)switch(r[e].name){case"data-id":a=r[e].value;break;case"completionstate":n=r[e].value,i=t(r[e]);break;case"modulename":l=t(r[e])}t.post({url:M.cfg.wwwroot+"/course/togglecompletion.php",data:"id="+o.getAttribute("data-id")+"&completionstate="+o.getAttribute("data-completionstate")+"&fromajax=1&sesskey="+M.cfg.sesskey}).done(c).fail(s)};return{init:function(){for(let e=0;e<r.length;e++)if("checkbox"===r[e].type&&r[e].className.includes("completioncheck")){let o="checkbox-parent";r[e].checked&&(o+=" active"),r[e].disabled&&(o+=" disable"),r[e].parentNode.className=o,r[e].onchange=function(e){d(e);let o="checkbox-parent";"1"===e.target.getAttribute("data-completionstate")?(o+=" active",e.target.setAttribute("data-completionstate",0),t.when(i).done(function(o){t(e.target.parentNode).tooltip("hide").attr("data-original-title",o).tooltip("show")})):(e.target.setAttribute("data-completionstate",1),t.when(l).done(function(o){t(e.target.parentNode).tooltip("hide").attr("data-original-title",o).tooltip("show")})),e.target.disabled&&(o+=" disable"),e.target.parentNode.className=o}}let e=Y.one("#completionprogressid");!e||Y.one("form.togglecompletion")||Y.one(".autocompletion")||e.setStyle("display","none")}}});